// MAKE SVG -> CANVAS POSSIBLE IN IE/SAFARI BY CONVERTING INTO PNG

// HELPER 1
// ADD BASE64 FOR OLDER IE VERSIONS
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="",d,b,f,g,h,e,k=0;for(c=Base64._utf8_encode(c);k<c.length;)d=c.charCodeAt(k++),b=c.charCodeAt(k++),f=c.charCodeAt(k++),g=d>>2,d=(d&3)<<4|b>>4,h=(b&15)<<2|f>>6,e=f&63,isNaN(b)?h=e=64:isNaN(f)&&(e=64),a=a+this._keyStr.charAt(g)+this._keyStr.charAt(d)+this._keyStr.charAt(h)+this._keyStr.charAt(e);return a},decode:function(c){var a="",d,b,f,g,h,e=0;for(c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");e<
c.length;)d=this._keyStr.indexOf(c.charAt(e++)),b=this._keyStr.indexOf(c.charAt(e++)),g=this._keyStr.indexOf(c.charAt(e++)),h=this._keyStr.indexOf(c.charAt(e++)),d=d<<2|b>>4,b=(b&15)<<4|g>>2,f=(g&3)<<6|h,a+=String.fromCharCode(d),64!=g&&(a+=String.fromCharCode(b)),64!=h&&(a+=String.fromCharCode(f));return a=Base64._utf8_decode(a)},_utf8_encode:function(c){c=c.replace(/\r\n/g,"\n");for(var a="",d=0;d<c.length;d++){var b=c.charCodeAt(d);128>b?a+=String.fromCharCode(b):(127<b&&2048>b?a+=String.fromCharCode(b>>
6|192):(a+=String.fromCharCode(b>>12|224),a+=String.fromCharCode(b>>6&63|128)),a+=String.fromCharCode(b&63|128))}return a},_utf8_decode:function(c){for(var a="",d=0,b=c1=c2=0;d<c.length;)b=c.charCodeAt(d),128>b?(a+=String.fromCharCode(b),d++):191<b&&224>b?(c2=c.charCodeAt(d+1),a+=String.fromCharCode((b&31)<<6|c2&63),d+=2):(c2=c.charCodeAt(d+1),c3=c.charCodeAt(d+2),a+=String.fromCharCode((b&15)<<12|(c2&63)<<6|c3&63),d+=3);return a}};

// HELPER 2
// SVG TO PNG FALLBACK FOR SOME BROWSERS
(function(){function x(n){var a={opts:n,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3E4,log:function(a){}};!0==a.opts.log&&"undefined"!=typeof console&&(a.log=function(a){console.log(a)});a.init=function(c){var b=0;a.UniqueId=function(){b++;return"canvg"+b};a.Definitions={};a.Styles={};a.Animations=[];a.Images=[];a.ctx=c;a.ViewPort=new function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(b,a){this.viewPorts.push({width:b,height:a})};this.RemoveCurrent=function(){this.viewPorts.pop()};
this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(b){return null!=b&&"number"==typeof b?b:"x"==b?this.width():"y"==b?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}};a.init();a.ImagesLoaded=function(){for(var c=0;c<a.Images.length;c++)if(!a.Images[c].loaded)return!1;return!0};a.trim=function(a){return a.replace(/^\s+|\s+$/g,
"")};a.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")};a.ajax=function(a){var b;return(b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(b.open("GET",a,!1),b.send(null),b.responseText):null};a.parseXml=function(a){if(window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a);return b};a.Property=function(a,b){this.name=a;this.value=
b};a.Property.prototype.getValue=function(){return this.value};a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value};a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);(this.value+"").match(/%$/)&&(a/=100);return a};a.Property.prototype.valueOrDefault=function(a){return this.hasValue()?this.value:a};a.Property.prototype.numValueOrDefault=function(a){return this.hasValue()?this.numValue():a};a.Property.prototype.addOpacity=
function(c){var b=this.value;if(null!=c.value&&""!=c.value&&"string"==typeof this.value){var d=new RGBColor(this.value);d.ok&&(b="rgba("+d.r+", "+d.g+", "+d.b+", "+c.numValue()+")")}return new a.Property(this.name,b)};a.Property.prototype.getDefinition=function(){var c=this.value.match(/#([^\)'"]+)/);c&&(c=c[1]);c||(c=this.value);return a.Definitions[c]};a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")};a.Property.prototype.getFillStyleDefinition=function(c,b){var d=
this.getDefinition();if(null!=d&&d.createGradient)return d.createGradient(a.ctx,c,b);if(null!=d&&d.createPattern){if(d.getHrefAttribute().hasValue()){var e=d.attribute("patternTransform"),d=d.getHrefAttribute().getDefinition();e.hasValue()&&(d.attribute("patternTransform",!0).value=e.value)}return d.createPattern(a.ctx,c)}return null};a.Property.prototype.getDPI=function(a){return 96};a.Property.prototype.getEM=function(c){var b=12,d=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);d.hasValue()&&
(b=d.toPixels(c));return b};a.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")};a.Property.prototype.toPixels=function(c,b){if(!this.hasValue())return 0;var d=this.value+"";if(d.match(/em$/))return this.numValue()*this.getEM(c);if(d.match(/ex$/))return this.numValue()*this.getEM(c)/2;if(d.match(/px$/))return this.numValue();if(d.match(/pt$/))return this.numValue()*this.getDPI(c)*(1/72);if(d.match(/pc$/))return 15*this.numValue();if(d.match(/cm$/))return this.numValue()*
this.getDPI(c)/2.54;if(d.match(/mm$/))return this.numValue()*this.getDPI(c)/25.4;if(d.match(/in$/))return this.numValue()*this.getDPI(c);if(d.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(c);d=this.numValue();return b&&1>d?d*a.ViewPort.ComputeSize(c):d};a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var a=this.value+"";if(a.match(/s$/))return 1E3*this.numValue();a.match(/ms$/);return this.numValue()};a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;
var a=this.value+"";return a.match(/deg$/)?this.numValue()*(Math.PI/180):a.match(/grad$/)?this.numValue()*(Math.PI/200):a.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var s={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};a.Property.prototype.toTextBaseline=function(){return this.hasValue()?
s[this.value]:null};a.Font=new function(){this.Styles="normal|italic|oblique|inherit";this.Variants="normal|small-caps|inherit";this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";this.CreateFont=function(b,d,e,c,g,h){h=null!=h?this.Parse(h):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:g||h.fontFamily,fontSize:c||h.fontSize,fontStyle:b||h.fontStyle,fontWeight:e||h.fontWeight,fontVariant:d||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,
this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var c=this;this.Parse=function(b){var d={};b=a.trim(a.compressSpaces(b||"")).split(" ");for(var e=!1,f=!1,g=!1,h=!1,k="",l=0;l<b.length;l++)f||-1==c.Styles.indexOf(b[l])?h||-1==c.Variants.indexOf(b[l])?g||-1==c.Weights.indexOf(b[l])?e?"inherit"!=b[l]&&(k+=b[l]):("inherit"!=b[l]&&(d.fontSize=b[l].split("/")[0]),f=h=g=e=!0):("inherit"!=b[l]&&(d.fontWeight=b[l]),f=h=g=!0):("inherit"!=b[l]&&(d.fontVariant=b[l]),f=h=!0):("inherit"!=b[l]&&(d.fontStyle=
b[l]),f=!0);""!=k&&(d.fontFamily=k);return d}};a.ToNumberArray=function(c){c=a.trim(a.compressSpaces((c||"").replace(/,/g," "))).split(" ");for(var b=0;b<c.length;b++)c[b]=parseFloat(c[b]);return c};a.Point=function(a,b){this.x=a;this.y=b};a.Point.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)};a.Point.prototype.applyTransform=function(a){var b=this.x*a[1]+this.y*a[3]+a[5];this.x=this.x*a[0]+this.y*a[2]+a[4];this.y=b};a.CreatePoint=function(c){c=a.ToNumberArray(c);return new a.Point(c[0],
c[1])};a.CreatePath=function(c){c=a.ToNumberArray(c);for(var b=[],d=0;d<c.length;d+=2)b.push(new a.Point(c[d],c[d+1]));return b};a.BoundingBox=function(a,b,d,e){this.y2=this.x2=this.y1=this.x1=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(a,b){if(null!=a){if(isNaN(this.x1)||isNaN(this.x2))this.x2=this.x1=a;a<this.x1&&(this.x1=a);a>this.x2&&(this.x2=a)}if(null!=
b){if(isNaN(this.y1)||isNaN(this.y2))this.y2=this.y1=b;b<this.y1&&(this.y1=b);b>this.y2&&(this.y2=b)}};this.addX=function(a){this.addPoint(a,null)};this.addY=function(a){this.addPoint(null,a)};this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1);this.addPoint(a.x2,a.y2)};this.addQuadraticCurve=function(a,b,d,e,c,m){d=a+2/3*(d-a);e=b+2/3*(e-b);this.addBezierCurve(a,b,d,d+1/3*(c-a),e,e+1/3*(m-b),c,m)};this.addBezierCurve=function(a,b,d,e,c,m,r,p){var t=[a,b],q=[d,e],n=[c,m],s=[r,p];this.addPoint(t[0],
t[1]);this.addPoint(s[0],s[1]);for(i=0;1>=i;i++)a=function(a){return Math.pow(1-a,3)*t[i]+3*Math.pow(1-a,2)*a*q[i]+3*(1-a)*Math.pow(a,2)*n[i]+Math.pow(a,3)*s[i]},b=6*t[i]-12*q[i]+6*n[i],d=-3*t[i]+9*q[i]-9*n[i]+3*s[i],e=3*q[i]-3*t[i],0==d?0!=b&&(b=-e/b,0<b&&1>b&&(0==i&&this.addX(a(b)),1==i&&this.addY(a(b)))):(e=Math.pow(b,2)-4*e*d,0>e||(c=(-b+Math.sqrt(e))/(2*d),0<c&&1>c&&(0==i&&this.addX(a(c)),1==i&&this.addY(a(c))),b=(-b-Math.sqrt(e))/(2*d),0<b&&1>b&&(0==i&&this.addX(a(b)),1==i&&this.addY(a(b)))))};
this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2};this.addPoint(a,b);this.addPoint(d,e)};a.Transform=function(c){var b=this;this.Type={};this.Type.translate=function(b){this.p=a.CreatePoint(b);this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)};this.unapply=function(a){a.translate(-1*this.p.x||0,-1*this.p.y||0)};this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=function(b){b=a.ToNumberArray(b);this.angle=
new a.Property("angle",b[0]);this.cx=b[1]||0;this.cy=b[2]||0;this.apply=function(a){a.translate(this.cx,this.cy);a.rotate(this.angle.toRadians());a.translate(-this.cx,-this.cy)};this.unapply=function(a){a.translate(this.cx,this.cy);a.rotate(-1*this.angle.toRadians());a.translate(-this.cx,-this.cy)};this.applyToPoint=function(a){var b=this.angle.toRadians();a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);a.applyTransform([Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0]);a.applyTransform([1,
0,0,1,-this.p.x||0,-this.p.y||0])}};this.Type.scale=function(b){this.p=a.CreatePoint(b);this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)};this.unapply=function(a){a.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)};this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(b){this.m=a.ToNumberArray(b);this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.unapply=function(a){a.transform(this.m[0],
this.m[1],this.m[2],this.m[3],-1*this.m[4],-1*this.m[5])};this.applyToPoint=function(a){a.applyTransform(this.m)}};this.Type.SkewBase=function(d){this.base=b.Type.matrix;this.base(d);this.angle=new a.Property("angle",d)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(a){this.base=b.Type.SkewBase;this.base(a);this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(a){this.base=b.Type.SkewBase;this.base(a);
this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].apply(a)};this.unapply=function(a){for(var b=this.transforms.length-1;0<=b;b--)this.transforms[b].unapply(a)};this.applyToPoint=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].applyToPoint(a)};c=a.trim(a.compressSpaces(c)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,
") ").split(/\s(?=[a-z])/);for(var d=0;d<c.length;d++){var e=a.trim(c[d].split("(")[0]),f=c[d].split("(")[1].replace(")",""),f=new this.Type[e](f);f.type=e;this.transforms.push(f)}};a.AspectRatio=function(c,b,d,e,f,g,h,k,l,m){b=a.compressSpaces(b);b=b.replace(/^defer\s/,"");var r=b.split(" ")[0]||"xMidYMid";b=b.split(" ")[1]||"meet";var p=d/e,t=f/g,q=Math.min(p,t),n=Math.max(p,t);"meet"==b&&(e*=q,g*=q);"slice"==b&&(e*=n,g*=n);l=new a.Property("refX",l);m=new a.Property("refY",m);l.hasValue()&&m.hasValue()?
c.translate(-q*l.toPixels("x"),-q*m.toPixels("y")):(r.match(/^xMid/)&&("meet"==b&&q==t||"slice"==b&&n==t)&&c.translate(d/2-e/2,0),r.match(/YMid$/)&&("meet"==b&&q==p||"slice"==b&&n==p)&&c.translate(0,f/2-g/2),r.match(/^xMax/)&&("meet"==b&&q==t||"slice"==b&&n==t)&&c.translate(d-e,0),r.match(/YMax$/)&&("meet"==b&&q==p||"slice"==b&&n==p)&&c.translate(0,f-g));"none"==r?c.scale(p,t):"meet"==b?c.scale(q,q):"slice"==b&&c.scale(n,n);c.translate(null==h?0:-h,null==k?0:-k)};a.Element={};a.EmptyProperty=new a.Property("EMPTY",
"");a.Element.ElementBase=function(c){this.attributes={};this.styles={};this.children=[];this.attribute=function(b,d){var e=this.attributes[b];if(null!=e)return e;!0==d&&(e=new a.Property(b,""),this.attributes[b]=e);return e||a.EmptyProperty};this.getHrefAttribute=function(){for(var b in this.attributes)if(b.match(/:href$/))return this.attributes[b];return a.EmptyProperty};this.style=function(b,d,e){var c=this.styles[b];if(null!=c)return c;var f=this.attribute(b);if(null!=f&&f.hasValue())return this.styles[b]=
f;if(!0!=e&&(e=this.parent,null!=e&&(e=e.style(b),null!=e&&e.hasValue())))return e;!0==d&&(c=new a.Property(b,""),this.styles[b]=c);return c||a.EmptyProperty};this.render=function(a){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){a.save();if(this.attribute("mask").hasValue()){var b=this.attribute("mask").getDefinition();null!=b&&b.apply(a,this)}else this.style("filter").hasValue()?(b=this.style("filter").getDefinition(),null!=b&&b.apply(a,this)):(this.setContext(a),
this.renderChildren(a),this.clearContext(a));a.restore()}};this.setContext=function(a){};this.clearContext=function(a){};this.renderChildren=function(a){for(var b=0;b<this.children.length;b++)this.children[b].render(a)};this.addChild=function(b,d){var e=b;d&&(e=a.CreateElement(b));e.parent=this;"title"!=e.type&&this.children.push(e)};if(null!=c&&1==c.nodeType){for(var b=0;b<c.childNodes.length;b++){var d=c.childNodes[b];1==d.nodeType&&this.addChild(d,!0);!this.captureTextNodes||3!=d.nodeType&&4!=
d.nodeType||""!=a.trim(a.compressSpaces(d.nodeValue||d.text||""))&&this.addChild(new a.Element.tspan(d),!1)}for(b=0;b<c.attributes.length;b++)d=c.attributes[b],this.attributes[d.nodeName]=new a.Property(d.nodeName,d.nodeValue);d=a.Styles[c.nodeName];if(null!=d)for(var e in d)this.styles[e]=d[e];if(this.attribute("class").hasValue())for(var b=a.compressSpaces(this.attribute("class").value).split(" "),f=0;f<b.length;f++){d=a.Styles["."+b[f]];if(null!=d)for(e in d)this.styles[e]=d[e];d=a.Styles[c.nodeName+
"."+b[f]];if(null!=d)for(e in d)this.styles[e]=d[e]}if(this.attribute("id").hasValue()&&(d=a.Styles["#"+this.attribute("id").value],null!=d))for(e in d)this.styles[e]=d[e];if(this.attribute("style").hasValue())for(d=this.attribute("style").value.split(";"),b=0;b<d.length;b++)""!=a.trim(d[b])&&(c=d[b].split(":"),e=a.trim(c[0]),c=a.trim(c[1]),this.styles[e]=new a.Property(e,c));this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=
this)}};a.Element.RenderedElementBase=function(c){this.base=a.Element.ElementBase;this.base(c);this.setContext=function(b){if(this.style("fill").isUrlDefinition()){var d=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=d&&(b.fillStyle=d)}else this.style("fill").hasValue()&&(d=this.style("fill"),"currentColor"==d.value&&(d.value=this.style("color").value),b.fillStyle="none"==d.value?"rgba(0,0,0,0)":d.value);this.style("fill-opacity").hasValue()&&(d=new a.Property("fill",
b.fillStyle),d=d.addOpacity(this.style("fill-opacity")),b.fillStyle=d.value);this.style("stroke").isUrlDefinition()?(d=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")),null!=d&&(b.strokeStyle=d)):this.style("stroke").hasValue()&&(d=this.style("stroke"),"currentColor"==d.value&&(d.value=this.style("color").value),b.strokeStyle="none"==d.value?"rgba(0,0,0,0)":d.value);this.style("stroke-opacity").hasValue()&&(d=new a.Property("stroke",b.strokeStyle),d=d.addOpacity(this.style("stroke-opacity")),
b.strokeStyle=d.value);this.style("stroke-width").hasValue()&&(d=this.style("stroke-width").toPixels(),b.lineWidth=0==d?.001:d);this.style("stroke-linecap").hasValue()&&(b.lineCap=this.style("stroke-linecap").value);this.style("stroke-linejoin").hasValue()&&(b.lineJoin=this.style("stroke-linejoin").value);this.style("stroke-miterlimit").hasValue()&&(b.miterLimit=this.style("stroke-miterlimit").value);this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value&&(d=a.ToNumberArray(this.style("stroke-dasharray").value),
"undefined"!=typeof b.setLineDash?b.setLineDash(d):"undefined"!=typeof b.webkitLineDash?b.webkitLineDash=d:"undefined"==typeof b.mozDash||1==d.length&&0==d[0]||(b.mozDash=d),d=this.style("stroke-dashoffset").numValueOrDefault(1),"undefined"!=typeof b.lineDashOffset?b.lineDashOffset=d:"undefined"!=typeof b.webkitLineDashOffset?b.webkitLineDashOffset=d:"undefined"!=typeof b.mozDashOffset&&(b.mozDashOffset=d));"undefined"!=typeof b.font&&(b.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,
this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString());this.attribute("transform").hasValue()&&(new a.Transform(this.attribute("transform").value)).apply(b);this.style("clip-path",!1,!0).hasValue()&&(d=this.style("clip-path",!1,!0).getDefinition(),null!=d&&d.apply(b));this.style("opacity").hasValue()&&(b.globalAlpha=this.style("opacity").numValue())}};a.Element.RenderedElementBase.prototype=new a.Element.ElementBase;
a.Element.PathElementBase=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.path=function(b){null!=b&&b.beginPath();return new a.BoundingBox};this.renderChildren=function(b){this.path(b);a.Mouse.checkPath(this,b);""!=b.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?b.fill(this.style("fill-rule").value):b.fill());""!=b.strokeStyle&&b.stroke();var d=this.getMarkers();if(null!=d){if(this.style("marker-start").isUrlDefinition()){var e=this.style("marker-start").getDefinition();
e.render(b,d[0][0],d[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var e=this.style("marker-mid").getDefinition(),c=1;c<d.length-1;c++)e.render(b,d[c][0],d[c][1]);this.style("marker-end").isUrlDefinition()&&(e=this.style("marker-end").getDefinition(),e.render(b,d[d.length-1][0],d[d.length-1][1]))}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase;a.Element.svg=function(c){this.base=
a.Element.RenderedElementBase;this.base(c);this.baseClearContext=this.clearContext;this.clearContext=function(b){this.baseClearContext(b);a.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(b){b.strokeStyle="rgba(0,0,0,0)";b.lineCap="butt";b.lineJoin="miter";b.miterLimit=4;"undefined"!=typeof b.font&&"undefined"!=typeof window.getComputedStyle&&(b.font=window.getComputedStyle(b.canvas).getPropertyValue("font"));this.baseSetContext(b);this.attribute("x").hasValue()||
(this.attribute("x",!0).value=0);this.attribute("y").hasValue()||(this.attribute("y",!0).value=0);b.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var d=a.ViewPort.width(),e=a.ViewPort.height();this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%");this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%");if("undefined"==typeof this.root){var d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y"),
c=0,g=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(c=-this.attribute("refX").toPixels("x"),g=-this.attribute("refY").toPixels("y"));"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(b.beginPath(),b.moveTo(c,g),b.lineTo(d,g),b.lineTo(d,e),b.lineTo(c,e),b.closePath(),b.clip())}a.ViewPort.SetCurrent(d,e);if(this.attribute("viewBox").hasValue()){var c=a.ToNumberArray(this.attribute("viewBox").value),g=c[0],h=c[1],d=c[2],e=c[3];a.AspectRatio(b,this.attribute("preserveAspectRatio").value,
a.ViewPort.width(),d,a.ViewPort.height(),e,g,h,this.attribute("refX").value,this.attribute("refY").value);a.ViewPort.RemoveCurrent();a.ViewPort.SetCurrent(c[2],c[3])}}};a.Element.svg.prototype=new a.Element.RenderedElementBase;a.Element.rect=function(c){this.base=a.Element.PathElementBase;this.base(c);this.path=function(b){var d=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),c=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y"),h=this.attribute("rx").toPixels("x"),
k=this.attribute("ry").toPixels("y");this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(k=h);this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(h=k);h=Math.min(h,c/2);k=Math.min(k,g/2);null!=b&&(b.beginPath(),b.moveTo(d+h,e),b.lineTo(d+c-h,e),b.quadraticCurveTo(d+c,e,d+c,e+k),b.lineTo(d+c,e+g-k),b.quadraticCurveTo(d+c,e+g,d+c-h,e+g),b.lineTo(d+h,e+g),b.quadraticCurveTo(d,e+g,d,e+g-k),b.lineTo(d,e+k),b.quadraticCurveTo(d,e,d+h,e),b.closePath());return new a.BoundingBox(d,
e,d+c,e+g)}};a.Element.rect.prototype=new a.Element.PathElementBase;a.Element.circle=function(c){this.base=a.Element.PathElementBase;this.base(c);this.path=function(b){var d=this.attribute("cx").toPixels("x"),e=this.attribute("cy").toPixels("y"),c=this.attribute("r").toPixels();null!=b&&(b.beginPath(),b.arc(d,e,c,0,2*Math.PI,!0),b.closePath());return new a.BoundingBox(d-c,e-c,d+c,e+c)}};a.Element.circle.prototype=new a.Element.PathElementBase;a.Element.ellipse=function(c){this.base=a.Element.PathElementBase;
this.base(c);this.path=function(b){var d=4*((Math.sqrt(2)-1)/3),e=this.attribute("rx").toPixels("x"),c=this.attribute("ry").toPixels("y"),g=this.attribute("cx").toPixels("x"),h=this.attribute("cy").toPixels("y");null!=b&&(b.beginPath(),b.moveTo(g,h-c),b.bezierCurveTo(g+d*e,h-c,g+e,h-d*c,g+e,h),b.bezierCurveTo(g+e,h+d*c,g+d*e,h+c,g,h+c),b.bezierCurveTo(g-d*e,h+c,g-e,h+d*c,g-e,h),b.bezierCurveTo(g-e,h-d*c,g-d*e,h-c,g,h-c),b.closePath());return new a.BoundingBox(g-e,h-c,g+e,h+c)}};a.Element.ellipse.prototype=
new a.Element.PathElementBase;a.Element.line=function(c){this.base=a.Element.PathElementBase;this.base(c);this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]};this.path=function(b){var d=this.getPoints();null!=b&&(b.beginPath(),b.moveTo(d[0].x,d[0].y),b.lineTo(d[1].x,d[1].y));return new a.BoundingBox(d[0].x,d[0].y,d[1].x,d[1].y)};this.getMarkers=function(){var a=
this.getPoints(),d=a[0].angleTo(a[1]);return[[a[0],d],[a[1],d]]}};a.Element.line.prototype=new a.Element.PathElementBase;a.Element.polyline=function(c){this.base=a.Element.PathElementBase;this.base(c);this.points=a.CreatePath(this.attribute("points").value);this.path=function(b){var d=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=b&&(b.beginPath(),b.moveTo(this.points[0].x,this.points[0].y));for(var c=1;c<this.points.length;c++)d.addPoint(this.points[c].x,this.points[c].y),null!=b&&b.lineTo(this.points[c].x,
this.points[c].y);return d};this.getMarkers=function(){for(var a=[],d=0;d<this.points.length-1;d++)a.push([this.points[d],this.points[d].angleTo(this.points[d+1])]);a.push([this.points[this.points.length-1],a[a.length-1][1]]);return a}};a.Element.polyline.prototype=new a.Element.PathElementBase;a.Element.polygon=function(c){this.base=a.Element.polyline;this.base(c);this.basePath=this.path;this.path=function(a){var d=this.basePath(a);null!=a&&(a.lineTo(this.points[0].x,this.points[0].y),a.closePath());
return d}};a.Element.polygon.prototype=new a.Element.polyline;a.Element.path=function(c){this.base=a.Element.PathElementBase;this.base(c);c=this.attribute("d").value;c=c.replace(/,/gm," ");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");c=c.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([0-9])([+\-])/gm,"$1 $2");c=c.replace(/(\.[0-9]*)(\.)/gm,
"$1 $2");c=c.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");c=a.compressSpaces(c);c=a.trim(c);this.PathParser=new function(b){this.tokens=b.split(" ");this.reset=function(){this.i=-1;this.previousCommand=this.command="";this.start=new a.Point(0,0);this.control=new a.Point(0,0);this.current=new a.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-1};this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)};
this.isRelativeCommand=function(){switch(this.command){case "m":case "l":case "h":case "v":case "c":case "s":case "q":case "t":case "a":case "z":return!0}return!1};this.getToken=function(){this.i++;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){var b=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(b)};this.getAsControlPoint=
function(){var a=this.getPoint();return this.control=a};this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a};this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)};this.makeAbsolute=function(a){this.isRelativeCommand()&&(a.x+=this.current.x,
a.y+=this.current.y);return a};this.addMarker=function(a,b,c){null!=c&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c));this.addMarkerAngle(a,null==b?null:b.angleTo(a))};this.addMarkerAngle=function(a,b){this.points.push(a);this.angles.push(b)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==this.angles[a])for(var b=a+1;b<
this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(c);this.path=function(b){var d=this.PathParser;d.reset();var c=new a.BoundingBox;for(null!=b&&b.beginPath();!d.isEnd();)switch(d.nextCommand(),d.command){case "M":case "m":var f=d.getAsCurrentPoint();d.addMarker(f);c.addPoint(f.x,f.y);null!=b&&b.moveTo(f.x,f.y);for(d.start=d.current;!d.isCommandOrEnd();)f=d.getAsCurrentPoint(),d.addMarker(f,d.start),c.addPoint(f.x,f.y),null!=b&&b.lineTo(f.x,f.y);
break;case "L":case "l":for(;!d.isCommandOrEnd();){var g=d.current,f=d.getAsCurrentPoint();d.addMarker(f,g);c.addPoint(f.x,f.y);null!=b&&b.lineTo(f.x,f.y)}break;case "H":case "h":for(;!d.isCommandOrEnd();)f=new a.Point((d.isRelativeCommand()?d.current.x:0)+d.getScalar(),d.current.y),d.addMarker(f,d.current),d.current=f,c.addPoint(d.current.x,d.current.y),null!=b&&b.lineTo(d.current.x,d.current.y);break;case "V":case "v":for(;!d.isCommandOrEnd();)f=new a.Point(d.current.x,(d.isRelativeCommand()?d.current.y:
0)+d.getScalar()),d.addMarker(f,d.current),d.current=f,c.addPoint(d.current.x,d.current.y),null!=b&&b.lineTo(d.current.x,d.current.y);break;case "C":case "c":for(;!d.isCommandOrEnd();){var h=d.current,g=d.getPoint(),k=d.getAsControlPoint(),f=d.getAsCurrentPoint();d.addMarker(f,k,g);c.addBezierCurve(h.x,h.y,g.x,g.y,k.x,k.y,f.x,f.y);null!=b&&b.bezierCurveTo(g.x,g.y,k.x,k.y,f.x,f.y)}break;case "S":case "s":for(;!d.isCommandOrEnd();)h=d.current,g=d.getReflectedControlPoint(),k=d.getAsControlPoint(),f=
d.getAsCurrentPoint(),d.addMarker(f,k,g),c.addBezierCurve(h.x,h.y,g.x,g.y,k.x,k.y,f.x,f.y),null!=b&&b.bezierCurveTo(g.x,g.y,k.x,k.y,f.x,f.y);break;case "Q":case "q":for(;!d.isCommandOrEnd();)h=d.current,k=d.getAsControlPoint(),f=d.getAsCurrentPoint(),d.addMarker(f,k,k),c.addQuadraticCurve(h.x,h.y,k.x,k.y,f.x,f.y),null!=b&&b.quadraticCurveTo(k.x,k.y,f.x,f.y);break;case "T":case "t":for(;!d.isCommandOrEnd();)h=d.current,k=d.getReflectedControlPoint(),d.control=k,f=d.getAsCurrentPoint(),d.addMarker(f,
k,k),c.addQuadraticCurve(h.x,h.y,k.x,k.y,f.x,f.y),null!=b&&b.quadraticCurveTo(k.x,k.y,f.x,f.y);break;case "A":case "a":for(;!d.isCommandOrEnd();){var h=d.current,l=d.getScalar(),m=d.getScalar(),g=d.getScalar()*(Math.PI/180),r=d.getScalar(),k=d.getScalar(),f=d.getAsCurrentPoint(),p=new a.Point(Math.cos(g)*(h.x-f.x)/2+Math.sin(g)*(h.y-f.y)/2,-Math.sin(g)*(h.x-f.x)/2+Math.cos(g)*(h.y-f.y)/2),n=Math.pow(p.x,2)/Math.pow(l,2)+Math.pow(p.y,2)/Math.pow(m,2);1<n&&(l*=Math.sqrt(n),m*=Math.sqrt(n));r=(r==k?
-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(m,2)-Math.pow(l,2)*Math.pow(p.y,2)-Math.pow(m,2)*Math.pow(p.x,2))/(Math.pow(l,2)*Math.pow(p.y,2)+Math.pow(m,2)*Math.pow(p.x,2)));isNaN(r)&&(r=0);var q=new a.Point(r*l*p.y/m,r*-m*p.x/l),h=new a.Point((h.x+f.x)/2+Math.cos(g)*q.x-Math.sin(g)*q.y,(h.y+f.y)/2+Math.sin(g)*q.x+Math.cos(g)*q.y),s=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},v=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(s(a)*s(b))},w=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*
Math.acos(v(a,b))},r=w([1,0],[(p.x-q.x)/l,(p.y-q.y)/m]),n=[(p.x-q.x)/l,(p.y-q.y)/m],q=[(-p.x-q.x)/l,(-p.y-q.y)/m],p=w(n,q);-1>=v(n,q)&&(p=Math.PI);1<=v(n,q)&&(p=0);n=1-k?1:-1;q=r+p/2*n;w=new a.Point(h.x+l*Math.cos(q),h.y+m*Math.sin(q));d.addMarkerAngle(w,q-n*Math.PI/2);d.addMarkerAngle(f,q-n*Math.PI);c.addPoint(f.x,f.y);null!=b&&(v=l>m?l:m,f=l>m?1:l/m,l=l>m?m/l:1,b.translate(h.x,h.y),b.rotate(g),b.scale(f,l),b.arc(0,0,v,r,r+p,1-k),b.scale(1/f,1/l),b.rotate(-g),b.translate(-h.x,-h.y))}break;case "Z":case "z":null!=
b&&b.closePath(),d.current=d.start}return c};this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),d=this.PathParser.getMarkerAngles(),c=[],f=0;f<a.length;f++)c.push([a[f],d[f]]);return c}};a.Element.path.prototype=new a.Element.PathElementBase;a.Element.pattern=function(c){this.base=a.Element.ElementBase;this.base(c);this.createPattern=function(b,d){var c=this.attribute("width").toPixels("x",!0),f=this.attribute("height").toPixels("y",!0),g=new a.Element.svg;g.attributes.viewBox=
new a.Property("viewBox",this.attribute("viewBox").value);g.attributes.width=new a.Property("width",c+"px");g.attributes.height=new a.Property("height",f+"px");g.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value);g.children=this.children;var h=document.createElement("canvas");h.width=c;h.height=f;c=h.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&c.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",
!0));for(f=-1;1>=f;f++)for(var k=-1;1>=k;k++)c.save(),c.translate(f*h.width,k*h.height),g.render(c),c.restore();return b.createPattern(h,"repeat")}};a.Element.pattern.prototype=new a.Element.ElementBase;a.Element.marker=function(c){this.base=a.Element.ElementBase;this.base(c);this.baseRender=this.render;this.render=function(b,d,c){b.translate(d.x,d.y);"auto"==this.attribute("orient").valueOrDefault("auto")&&b.rotate(c);"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&b.scale(b.lineWidth,
b.lineWidth);b.save();var f=new a.Element.svg;f.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value);f.attributes.refX=new a.Property("refX",this.attribute("refX").value);f.attributes.refY=new a.Property("refY",this.attribute("refY").value);f.attributes.width=new a.Property("width",this.attribute("markerWidth").value);f.attributes.height=new a.Property("height",this.attribute("markerHeight").value);f.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black"));
f.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none"));f.children=this.children;f.render(b);b.restore();"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&b.scale(1/b.lineWidth,1/b.lineWidth);"auto"==this.attribute("orient").valueOrDefault("auto")&&b.rotate(-c);b.translate(-d.x,-d.y)}};a.Element.marker.prototype=new a.Element.ElementBase;a.Element.defs=function(c){this.base=a.Element.ElementBase;this.base(c);this.render=function(a){}};
a.Element.defs.prototype=new a.Element.ElementBase;a.Element.GradientBase=function(c){this.base=a.Element.ElementBase;this.base(c);this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox");this.stops=[];for(c=0;c<this.children.length;c++){var b=this.children[c];"stop"==b.type&&this.stops.push(b)}this.getGradient=function(){};this.createGradient=function(b,c,f){var g=this;this.getHrefAttribute().hasValue()&&(g=this.getHrefAttribute().getDefinition());var h=function(b){return f.hasValue()?
(new a.Property("color",b)).addOpacity(f).value:b};b=this.getGradient(b,c);if(null==b)return h(g.stops[g.stops.length-1].color);for(c=0;c<g.stops.length;c++)b.addColorStop(g.stops[c].offset,h(g.stops[c].color));return this.attribute("gradientTransform").hasValue()?(g=a.ViewPort.viewPorts[0],h=new a.Element.rect,h.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),h.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),h.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),h.attributes.height=
new a.Property("height",a.MAX_VIRTUAL_PIXELS),c=new a.Element.g,c.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),c.children=[h],h=new a.Element.svg,h.attributes.x=new a.Property("x",0),h.attributes.y=new a.Property("y",0),h.attributes.width=new a.Property("width",g.width),h.attributes.height=new a.Property("height",g.height),h.children=[c],c=document.createElement("canvas"),c.width=g.width,c.height=g.height,g=c.getContext("2d"),g.fillStyle=b,h.render(g),
g.createPattern(c,"no-repeat")):b}};a.Element.GradientBase.prototype=new a.Element.ElementBase;a.Element.linearGradient=function(c){this.base=a.Element.GradientBase;this.base(c);this.getGradient=function(a,d){var c="objectBoundingBox"==this.gradientUnits?d.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=
1,this.attribute("y2",!0).value=0);var f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),h="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),c="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("y2").numValue():
this.attribute("y2").toPixels("y");return f==h&&g==c?null:a.createLinearGradient(f,g,h,c)}};a.Element.linearGradient.prototype=new a.Element.GradientBase;a.Element.radialGradient=function(c){this.base=a.Element.GradientBase;this.base(c);this.getGradient=function(a,d){var c=d.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%");this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%");this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");
var f="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),g="objectBoundingBox"==this.gradientUnits?c.y()+c.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),h=f,k=g;this.attribute("fx").hasValue()&&(h="objectBoundingBox"==this.gradientUnits?c.x()+c.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x"));this.attribute("fy").hasValue()&&(k="objectBoundingBox"==this.gradientUnits?c.y()+
c.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));c="objectBoundingBox"==this.gradientUnits?(c.width()+c.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return a.createRadialGradient(h,k,0,f,g,c)}};a.Element.radialGradient.prototype=new a.Element.GradientBase;a.Element.stop=function(c){this.base=a.Element.ElementBase;this.base(c);this.offset=this.attribute("offset").numValue();0>this.offset&&(this.offset=0);1<this.offset&&(this.offset=1);c=this.style("stop-color");
this.style("stop-opacity").hasValue()&&(c=c.addOpacity(this.style("stop-opacity")));this.color=c.value};a.Element.stop.prototype=new a.Element.ElementBase;a.Element.AnimateBase=function(c){this.base=a.Element.ElementBase;this.base(c);a.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").toMilliseconds();this.getProperty=function(){var a=this.attribute("attributeType").value,d=this.attribute("attributeName").value;
return"CSS"==a?this.parent.style(d,!0):this.parent.attribute(d,!0)};this.initialValue=null;this.initialUnits="";this.removed=!1;this.calcValue=function(){return""};this.update=function(a){null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits());if(this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"==this.attribute("fill").valueOrDefault("remove")&&
!this.frozen)this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;else if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0;return!1}this.duration+=a;a=!1;this.begin<this.duration&&(a=this.calcValue(),this.attribute("type").hasValue()&&(a=this.attribute("type").value+"("+a+")"),this.getProperty().value=
a,a=!0);return a};this.from=this.attribute("from");this.to=this.attribute("to");this.values=this.attribute("values");this.values.hasValue()&&(this.values.value=this.values.value.split(";"));this.progress=function(){var b={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var d=b.progress*(this.values.value.length-1),c=Math.floor(d),f=Math.ceil(d);b.from=new a.Property("from",parseFloat(this.values.value[c]));b.to=new a.Property("to",parseFloat(this.values.value[f]));
b.progress=(d-c)/(f-c)}else b.from=this.from,b.to=this.to;return b}};a.Element.AnimateBase.prototype=new a.Element.ElementBase;a.Element.animate=function(c){this.base=a.Element.AnimateBase;this.base(c);this.calcValue=function(){var a=this.progress();return a.from.numValue()+(a.to.numValue()-a.from.numValue())*a.progress+this.initialUnits}};a.Element.animate.prototype=new a.Element.AnimateBase;a.Element.animateColor=function(c){this.base=a.Element.AnimateBase;this.base(c);this.calcValue=function(){var a=
this.progress(),d=new RGBColor(a.from.value),c=new RGBColor(a.to.value);if(d.ok&&c.ok){var f=d.g+(c.g-d.g)*a.progress,g=d.b+(c.b-d.b)*a.progress;return"rgb("+parseInt(d.r+(c.r-d.r)*a.progress,10)+","+parseInt(f,10)+","+parseInt(g,10)+")"}return this.attribute("from").value}};a.Element.animateColor.prototype=new a.Element.AnimateBase;a.Element.animateTransform=function(c){this.base=a.Element.AnimateBase;this.base(c);this.calcValue=function(){for(var b=this.progress(),d=a.ToNumberArray(b.from.value),
c=a.ToNumberArray(b.to.value),f="",g=0;g<d.length;g++)f+=d[g]+(c[g]-d[g])*b.progress+" ";return f}};a.Element.animateTransform.prototype=new a.Element.animate;a.Element.font=function(c){this.base=a.Element.ElementBase;this.base(c);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.isArabic=this.isRTL=!1;this.missingGlyph=this.fontFace=null;this.glyphs=[];for(c=0;c<this.children.length;c++){var b=this.children[c];"font-face"==b.type?(this.fontFace=b,b.style("font-family").hasValue()&&(a.Definitions[b.style("font-family").value]=
this)):"missing-glyph"==b.type?this.missingGlyph=b:"glyph"==b.type&&(""!=b.arabicForm?(this.isArabic=this.isRTL=!0,"undefined"==typeof this.glyphs[b.unicode]&&(this.glyphs[b.unicode]=[]),this.glyphs[b.unicode][b.arabicForm]=b):this.glyphs[b.unicode]=b)}};a.Element.font.prototype=new a.Element.ElementBase;a.Element.fontface=function(c){this.base=a.Element.ElementBase;this.base(c);this.ascent=this.attribute("ascent").value;this.descent=this.attribute("descent").value;this.unitsPerEm=this.attribute("units-per-em").numValue()};
a.Element.fontface.prototype=new a.Element.ElementBase;a.Element.missingglyph=function(c){this.base=a.Element.path;this.base(c);this.horizAdvX=0};a.Element.missingglyph.prototype=new a.Element.path;a.Element.glyph=function(c){this.base=a.Element.path;this.base(c);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.unicode=this.attribute("unicode").value;this.arabicForm=this.attribute("arabic-form").value};a.Element.glyph.prototype=new a.Element.path;a.Element.text=function(c){this.captureTextNodes=
!0;this.base=a.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);var d=this.style("dominant-baseline").toTextBaseline();null==d&&(d=this.style("alignment-baseline").toTextBaseline());null!=d&&(a.textBaseline=d)};this.getBoundingBox=function(){var b=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),c=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);return new a.BoundingBox(b,
d-c,b+Math.floor(2*c/3)*this.children[0].getText().length,d)};this.renderChildren=function(a){this.x=this.attribute("x").toPixels("x");this.y=this.attribute("y").toPixels("y");this.x+=this.getAnchorDelta(a,this,0);for(var d=0;d<this.children.length;d++)this.renderChild(a,this,d)};this.getAnchorDelta=function(a,d,c){var f=this.style("text-anchor").valueOrDefault("start");if("start"!=f){for(var g=0,h=c;h<d.children.length;h++){var k=d.children[h];if(h>c&&k.attribute("x").hasValue())break;g+=k.measureTextRecursive(a)}return-1*
("end"==f?g:g/2)}return 0};this.renderChild=function(a,d,c){var f=d.children[c];f.attribute("x").hasValue()?(f.x=f.attribute("x").toPixels("x")+this.getAnchorDelta(a,d,c),f.attribute("dx").hasValue()&&(f.x+=f.attribute("dx").toPixels("x"))):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),f.attribute("dx").hasValue()&&(this.x+=f.attribute("dx").toPixels("x")),f.x=this.x);this.x=f.x+f.measureText(a);f.attribute("y").hasValue()?(f.y=f.attribute("y").toPixels("y"),f.attribute("dy").hasValue()&&
(f.y+=f.attribute("dy").toPixels("y"))):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),f.attribute("dy").hasValue()&&(this.y+=f.attribute("dy").toPixels("y")),f.y=this.y);this.y=f.y;f.render(a);for(c=0;c<f.children.length;c++)this.renderChild(a,f,c)}};a.Element.text.prototype=new a.Element.RenderedElementBase;a.Element.TextElementBase=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.getGlyph=function(a,d,c){var f=d[c],g=null;if(a.isArabic){var h=
"isolated";(0==c||" "==d[c-1])&&c<d.length-2&&" "!=d[c+1]&&(h="terminal");0<c&&" "!=d[c-1]&&c<d.length-2&&" "!=d[c+1]&&(h="medial");0<c&&" "!=d[c-1]&&(c==d.length-1||" "==d[c+1])&&(h="initial");"undefined"!=typeof a.glyphs[f]&&(g=a.glyphs[f][h],null==g&&"glyph"==a.glyphs[f].type&&(g=a.glyphs[f]))}else g=a.glyphs[f];null==g&&(g=a.missingGlyph);return g};this.renderChildren=function(b){var c=this.parent.style("font-family").getDefinition();if(null!=c){var e=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),
f=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),g=this.getText();c.isRTL&&(g=g.split("").reverse().join(""));for(var h=a.ToNumberArray(this.parent.attribute("dx").value),k=0;k<g.length;k++){var l=this.getGlyph(c,g,k),m=e/c.fontFace.unitsPerEm;b.translate(this.x,this.y);b.scale(m,-m);var r=b.lineWidth;b.lineWidth=b.lineWidth*c.fontFace.unitsPerEm/e;"italic"==f&&b.transform(1,0,.4,1,0,0);l.render(b);"italic"==f&&b.transform(1,0,-.4,1,0,0);b.lineWidth=r;b.scale(1/
m,-1/m);b.translate(-this.x,-this.y);this.x+=e*(l.horizAdvX||c.horizAdvX)/c.fontFace.unitsPerEm;"undefined"==typeof h[k]||isNaN(h[k])||(this.x+=h[k])}}else""!=b.fillStyle&&b.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=b.strokeStyle&&b.strokeText(a.compressSpaces(this.getText()),this.x,this.y)};this.getText=function(){};this.measureTextRecursive=function(a){for(var c=this.measureText(a),e=0;e<this.children.length;e++)c+=this.children[e].measureTextRecursive(a);return c};this.measureText=
function(b){var c=this.parent.style("font-family").getDefinition();if(null!=c){b=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);var e=0,f=this.getText();c.isRTL&&(f=f.split("").reverse().join(""));for(var g=a.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var k=this.getGlyph(c,f,h),e=e+(k.horizAdvX||c.horizAdvX)*b/c.fontFace.unitsPerEm;"undefined"==typeof g[h]||isNaN(g[h])||(e+=g[h])}return e}c=a.compressSpaces(this.getText());if(!b.measureText)return 10*
c.length;b.save();this.setContext(b);c=b.measureText(c).width;b.restore();return c}};a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase;a.Element.tspan=function(c){this.captureTextNodes=!0;this.base=a.Element.TextElementBase;this.base(c);this.text=c.nodeValue||c.text||"";this.getText=function(){return this.text}};a.Element.tspan.prototype=new a.Element.TextElementBase;a.Element.tref=function(c){this.base=a.Element.TextElementBase;this.base(c);this.getText=function(){var a=this.getHrefAttribute().getDefinition();
if(null!=a)return a.children[0].getText()}};a.Element.tref.prototype=new a.Element.TextElementBase;a.Element.a=function(c){this.base=a.Element.TextElementBase;this.base(c);this.hasText=!0;for(var b=0;b<c.childNodes.length;b++)3!=c.childNodes[b].nodeType&&(this.hasText=!1);this.text=this.hasText?c.childNodes[0].nodeValue:"";this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(b){if(this.hasText){this.baseRenderChildren(b);var c=new a.Property("fontSize",
a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-c.toPixels("y"),this.x+this.measureText(b),this.y))}else c=new a.Element.g,c.children=this.children,c.parent=this,c.render(b)};this.onclick=function(){window.open(this.getHrefAttribute().value)};this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}};a.Element.a.prototype=new a.Element.TextElementBase;a.Element.image=function(c){this.base=a.Element.RenderedElementBase;this.base(c);var b=this.getHrefAttribute().value;
if(""!=b){var d=b.match(/\.svg$/);a.Images.push(this);this.loaded=!1;if(d)this.img=a.ajax(b),this.loaded=!0;else{this.img=document.createElement("img");!0==a.opts.useCORS&&(this.img.crossOrigin="Anonymous");var e=this;this.img.onload=function(){e.loaded=!0};this.img.onerror=function(){a.log('ERROR: image "'+b+'" not found');e.loaded=!0};this.img.src=b}this.renderChildren=function(b){var c=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),k=this.attribute("width").toPixels("x"),
l=this.attribute("height").toPixels("y");0!=k&&0!=l&&(b.save(),d?b.drawSvg(this.img,c,e,k,l):(b.translate(c,e),a.AspectRatio(b,this.attribute("preserveAspectRatio").value,k,this.img.width,l,this.img.height,0,0),b.drawImage(this.img,0,0)),b.restore())};this.getBoundingBox=function(){var b=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y");return new a.BoundingBox(b,c,b+d,c+e)}}};a.Element.image.prototype=
new a.Element.RenderedElementBase;a.Element.g=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.getBoundingBox=function(){for(var b=new a.BoundingBox,c=0;c<this.children.length;c++)b.addBoundingBox(this.children[c].getBoundingBox());return b}};a.Element.g.prototype=new a.Element.RenderedElementBase;a.Element.symbol=function(c){this.base=a.Element.RenderedElementBase;this.base(c);this.render=function(a){}};a.Element.symbol.prototype=new a.Element.RenderedElementBase;a.Element.style=
function(c){this.base=a.Element.ElementBase;this.base(c);for(var b="",d=0;d<c.childNodes.length;d++)b+=c.childNodes[d].nodeValue;b=b.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");b=a.compressSpaces(b);c=b.split("}");for(d=0;d<c.length;d++)if(""!=a.trim(c[d]))for(var e=c[d].split("{"),b=e[0].split(","),e=e[1].split(";"),f=0;f<b.length;f++){var g=a.trim(b[f]);if(""!=g){for(var h={},k=0;k<e.length;k++){var l=e[k].indexOf(":"),m=e[k].substr(0,l),l=e[k].substr(l+1,e[k].length-
l);null!=m&&null!=l&&(h[a.trim(m)]=new a.Property(a.trim(m),a.trim(l)))}a.Styles[g]=h;if("@font-face"==g)for(g=h["font-family"].value.replace(/"/g,""),h=h.src.value.split(","),k=0;k<h.length;k++)if(0<h[k].indexOf('format("svg")'))for(m=h[k].indexOf("url"),l=h[k].indexOf(")",m),m=h[k].substr(m+5,l-m-6),m=a.parseXml(a.ajax(m)).getElementsByTagName("font"),l=0;l<m.length;l++){var r=a.CreateElement(m[l]);a.Definitions[g]=r}}}};a.Element.style.prototype=new a.Element.ElementBase;a.Element.use=function(c){this.base=
a.Element.RenderedElementBase;this.base(c);this.baseSetContext=this.setContext;this.setContext=function(a){this.baseSetContext(a);this.attribute("x").hasValue()&&a.translate(this.attribute("x").toPixels("x"),0);this.attribute("y").hasValue()&&a.translate(0,this.attribute("y").toPixels("y"))};var b=this.getHrefAttribute().getDefinition();this.path=function(a){null!=b&&b.path(a)};this.getBoundingBox=function(){if(null!=b)return b.getBoundingBox()};this.renderChildren=function(c){if(null!=b){var e=b;
"symbol"==b.type&&(e=new a.Element.svg,e.type="svg",e.attributes.viewBox=new a.Property("viewBox",b.attribute("viewBox").value),e.attributes.preserveAspectRatio=new a.Property("preserveAspectRatio",b.attribute("preserveAspectRatio").value),e.attributes.overflow=new a.Property("overflow",b.attribute("overflow").value),e.children=b.children);"svg"==e.type&&(this.attribute("width").hasValue()&&(e.attributes.width=new a.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&
(e.attributes.height=new a.Property("height",this.attribute("height").value)));var f=e.parent;e.parent=null;e.render(c);e.parent=f}}};a.Element.use.prototype=new a.Element.RenderedElementBase;a.Element.mask=function(c){this.base=a.Element.ElementBase;this.base(c);this.apply=function(b,c){var e=this.attribute("x").toPixels("x"),f=this.attribute("y").toPixels("y"),g=this.attribute("width").toPixels("x"),h=this.attribute("height").toPixels("y");if(0==g&&0==h){h=new a.BoundingBox;for(e=0;e<this.children.length;e++)h.addBoundingBox(this.children[e].getBoundingBox());
e=Math.floor(h.x1);f=Math.floor(h.y1);g=Math.floor(h.width());h=Math.floor(h.height())}var k=c.attribute("mask").value;c.attribute("mask").value="";var l=document.createElement("canvas");l.width=e+g;l.height=f+h;var m=l.getContext("2d");this.renderChildren(m);var r=document.createElement("canvas");r.width=e+g;r.height=f+h;var p=r.getContext("2d");c.render(p);p.globalCompositeOperation="destination-in";p.fillStyle=m.createPattern(l,"no-repeat");p.fillRect(0,0,e+g,f+h);b.fillStyle=p.createPattern(r,
"no-repeat");b.fillRect(0,0,e+g,f+h);c.attribute("mask").value=k};this.render=function(a){}};a.Element.mask.prototype=new a.Element.ElementBase;a.Element.clipPath=function(c){this.base=a.Element.ElementBase;this.base(c);this.apply=function(b){var c=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var e=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){};c.call(b);for(var f=0;f<this.children.length;f++){var g=
this.children[f];if("undefined"!=typeof g.path){var h=null;g.attribute("transform").hasValue()&&(h=new a.Transform(g.attribute("transform").value),h.apply(b));g.path(b);CanvasRenderingContext2D.prototype.closePath=e;h&&h.unapply(b)}}e.call(b);b.clip();CanvasRenderingContext2D.prototype.beginPath=c;CanvasRenderingContext2D.prototype.closePath=e};this.render=function(a){}};a.Element.clipPath.prototype=new a.Element.ElementBase;a.Element.filter=function(c){this.base=a.Element.ElementBase;this.base(c);
this.apply=function(a,c){var e=c.getBoundingBox(),f=Math.floor(e.x1),g=Math.floor(e.y1),h=Math.floor(e.width()),e=Math.floor(e.height()),k=c.style("filter").value;c.style("filter").value="";for(var l=0,m=0,r=0;r<this.children.length;r++)var p=this.children[r].extraFilterDistance||0,l=Math.max(l,p),m=Math.max(m,p);p=document.createElement("canvas");p.width=h+2*l;p.height=e+2*m;var n=p.getContext("2d");n.translate(-f+l,-g+m);c.render(n);for(r=0;r<this.children.length;r++)this.children[r].apply(n,0,
0,h+2*l,e+2*m);a.drawImage(p,0,0,h+2*l,e+2*m,f-l,g-m,h+2*l,e+2*m);c.style("filter",!0).value=k};this.render=function(a){}};a.Element.filter.prototype=new a.Element.ElementBase;a.Element.feMorphology=function(c){this.base=a.Element.ElementBase;this.base(c);this.apply=function(a,c,e,f,g){}};a.Element.feMorphology.prototype=new a.Element.ElementBase;a.Element.feComposite=function(c){this.base=a.Element.ElementBase;this.base(c);this.apply=function(a,c,e,f,g){}};a.Element.feComposite.prototype=new a.Element.ElementBase;
a.Element.feColorMatrix=function(c){function b(a,b){var c=d[a];return c*(0>c?b-255:b)}this.base=a.Element.ElementBase;this.base(c);var d=a.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case "saturate":c=d[0];d=[.213+.787*c,.715-.715*c,.072-.072*c,0,0,.213-.213*c,.715+.285*c,.072-.072*c,0,0,.213-.213*c,.715-.715*c,.072+.928*c,0,0,0,0,0,1,0,0,0,0,0,1];break;case "hueRotate":var e=d[0]*Math.PI/180;c=function(a,b,c){return a+Math.cos(e)*b+Math.sin(e)*
c};d=[c(.213,.787,-.213),c(.715,-.715,-.715),c(.072,-.072,.928),0,0,c(.213,-.213,.143),c(.715,.285,.14),c(.072,-.072,-.283),0,0,c(.213,-.213,-.787),c(.715,-.715,.715),c(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case "luminanceToAlpha":d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(a,c,d,e,l){var m=a.getImageData(0,0,e,l);for(d=0;d<l;d++)for(c=0;c<e;c++){var n=m.data[d*e*4+4*c+0],p=m.data[d*e*4+4*c+1],s=m.data[d*e*4+4*c+2],q=m.data[d*e*4+4*c+3],u=b(0,n)+
b(1,p)+b(2,s)+b(3,q)+b(4,1);m.data[d*e*4+4*c+0]=u;u=b(5,n)+b(6,p)+b(7,s)+b(8,q)+b(9,1);m.data[d*e*4+4*c+1]=u;u=b(10,n)+b(11,p)+b(12,s)+b(13,q)+b(14,1);m.data[d*e*4+4*c+2]=u;n=b(15,n)+b(16,p)+b(17,s)+b(18,q)+b(19,1);m.data[d*e*4+4*c+3]=n}a.clearRect(0,0,e,l);a.putImageData(m,0,0)}};a.Element.feColorMatrix.prototype=new a.Element.ElementBase;a.Element.feGaussianBlur=function(c){this.base=a.Element.ElementBase;this.base(c);this.extraFilterDistance=this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue());
this.apply=function(b,c,e,f,g){"undefined"==typeof stackBlurCanvasRGBA?a.log("ERROR: StackBlur.js must be included for blur to work"):(b.canvas.id=a.UniqueId(),b.canvas.style.display="none",document.body.appendChild(b.canvas),stackBlurCanvasRGBA(b.canvas.id,c,e,f,g,this.blurRadius),document.body.removeChild(b.canvas))}};a.Element.feGaussianBlur.prototype=new a.Element.ElementBase;a.Element.title=function(a){};a.Element.title.prototype=new a.Element.ElementBase;a.Element.desc=function(a){};a.Element.desc.prototype=
new a.Element.ElementBase;a.Element.MISSING=function(c){a.log("ERROR: Element '"+c.nodeName+"' not yet implemented.")};a.Element.MISSING.prototype=new a.Element.ElementBase;a.CreateElement=function(c){var b=c.nodeName.replace(/^[^:]+:/,""),b=b.replace(/\-/g,""),d=null,d="undefined"!=typeof a.Element[b]?new a.Element[b](c):new a.Element.MISSING(c);d.type=c.nodeName;return d};a.load=function(c,b){a.loadXml(c,a.ajax(b))};a.loadXml=function(c,b){a.loadXmlDoc(c,a.parseXml(b))};a.loadXmlDoc=function(c,
b){a.init(c);var d=function(a){for(var b=c.canvas;b;)a.x-=b.offsetLeft,a.y-=b.offsetTop,b=b.offsetParent;window.scrollX&&(a.x+=window.scrollX);window.scrollY&&(a.y+=window.scrollY);return a};!0!=a.opts.ignoreMouse&&(c.canvas.onclick=function(b){b=d(new a.Point(null!=b?b.clientX:event.clientX,null!=b?b.clientY:event.clientY));a.Mouse.onclick(b.x,b.y)},c.canvas.onmousemove=function(b){b=d(new a.Point(null!=b?b.clientX:event.clientX,null!=b?b.clientY:event.clientY));a.Mouse.onmousemove(b.x,b.y)});var e=
a.CreateElement(b.documentElement),f=e.root=!0,g=function(){a.ViewPort.Clear();c.canvas.parentNode&&a.ViewPort.SetCurrent(c.canvas.parentNode.clientWidth,c.canvas.parentNode.clientHeight);!0!=a.opts.ignoreDimensions&&(e.style("width").hasValue()&&(c.canvas.width=e.style("width").toPixels("x"),c.canvas.style.width=c.canvas.width+"px"),e.style("height").hasValue()&&(c.canvas.height=e.style("height").toPixels("y"),c.canvas.style.height=c.canvas.height+"px"));var d=c.canvas.clientWidth||c.canvas.width,
h=c.canvas.clientHeight||c.canvas.height;!0==a.opts.ignoreDimensions&&e.style("width").hasValue()&&e.style("height").hasValue()&&(d=e.style("width").toPixels("x"),h=e.style("height").toPixels("y"));a.ViewPort.SetCurrent(d,h);null!=a.opts.offsetX&&(e.attribute("x",!0).value=a.opts.offsetX);null!=a.opts.offsetY&&(e.attribute("y",!0).value=a.opts.offsetY);if(null!=a.opts.scaleWidth||null!=a.opts.scaleHeight){var g=null,n=null,p=a.ToNumberArray(e.attribute("viewBox").value);null!=a.opts.scaleWidth&&(e.attribute("width").hasValue()?
g=e.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(p[2])||(g=p[2]/a.opts.scaleWidth));null!=a.opts.scaleHeight&&(e.attribute("height").hasValue()?n=e.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(p[3])||(n=p[3]/a.opts.scaleHeight));null==g&&(g=n);null==n&&(n=g);e.attribute("width",!0).value=a.opts.scaleWidth;e.attribute("height",!0).value=a.opts.scaleHeight;e.attribute("transform",!0).value+=" scale("+1/g+","+1/n+")"}!0!=a.opts.ignoreClear&&c.clearRect(0,0,d,h);e.render(c);
f&&(f=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(b))},h=!0;a.ImagesLoaded()&&(h=!1,g());a.intervalID=setInterval(function(){var b=!1;h&&a.ImagesLoaded()&&(h=!1,b=!0);!0!=a.opts.ignoreMouse&&(b|=a.Mouse.hasEvents());if(!0!=a.opts.ignoreAnimation)for(var c=0;c<a.Animations.length;c++)b|=a.Animations[c].update(1E3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&!0==a.opts.forceRedraw()&&(b=!0);b&&(g(),a.Mouse.runEvents())},1E3/a.FRAMERATE)};a.stop=function(){a.intervalID&&
clearInterval(a.intervalID)};a.Mouse=new function(){this.events=[];this.hasEvents=function(){return 0!=this.events.length};this.onclick=function(a,b){this.events.push({type:"onclick",x:a,y:b,run:function(a){if(a.onclick)a.onclick()}})};this.onmousemove=function(a,b){this.events.push({type:"onmousemove",x:a,y:b,run:function(a){if(a.onmousemove)a.onmousemove()}})};this.eventElements=[];this.checkPath=function(a,b){for(var d=0;d<this.events.length;d++){var e=this.events[d];b.isPointInPath&&b.isPointInPath(e.x,
e.y)&&(this.eventElements[d]=a)}};this.checkBoundingBox=function(a,b){for(var d=0;d<this.events.length;d++){var e=this.events[d];b.isPointInBox(e.x,e.y)&&(this.eventElements[d]=a)}};this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var c=0;c<this.events.length;c++)for(var b=this.events[c],d=this.eventElements[c];d;)b.run(d),d=d.parent;this.events=[];this.eventElements=[]}};return a}this.canvg=function(n,a,s){if(null==n&&null==a&&null==s)for(a=document.querySelectorAll("svg"),n=0;n<a.length;n++){s=
a[n];var c=document.createElement("canvas");c.width=s.clientWidth;c.height=s.clientHeight;s.parentNode.insertBefore(c,s);s.parentNode.removeChild(s);var b=document.createElement("div");b.appendChild(s);canvg(c,b.innerHTML)}else{"string"==typeof n&&(n=document.getElementById(n));null!=n.svg&&n.svg.stop();s=x(s||{});if(1!=n.childNodes.length||"OBJECT"!=n.childNodes[0].nodeName)n.svg=s;n=n.getContext("2d");"undefined"!=typeof a.documentElement?s.loadXmlDoc(n,a):"<"==a.substr(0,1)?s.loadXml(n,a):s.load(n,
a)}}})();"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(x,n,a,s,c){canvg(this.canvas,x,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:n,offsetY:a,scaleWidth:s,scaleHeight:c})});

// MAIN FILE
// SVG to PNG - https://github.com/sampumon/SVG.toDataURL
SVGElement.prototype.toDataURL=function(f,d){function c(a){console.log("SVG.toDataURL:",a)}function m(){var a=h(g),a=l(a);c(f+" length: "+a.length);d.callback&&d.callback(a);return a}function h(a){function d(a){var b;b="<"+a.nodeName;for(var c=0;c<a.attributes.length;c++)b+=" "+a.attributes[c].name+"='"+a.attributes[c].value+"'";if(a.hasChildNodes()){b+=">\n";for(c=0;c<a.childNodes.length;c++)b+=d(a.childNodes[c]);b+="</"+a.nodeName+">\n"}else b+=" />\n";return b}if(window.XMLSerializer)return c("using standard XMLSerializer.serializeToString"),
(new XMLSerializer).serializeToString(a);c("using custom XMLSerializerForIE");return d(a)}function l(a){var d="data:image/svg+xml;base64,";window.btoa?(c("using window.btoa for base64 encoding"),d+=btoa(a)):(c("using custom base64 encoder"),d+=Base64.encode(a));return d}function n(){var a=document.createElement("canvas"),k=a.getContext("2d"),e=new Image,b=h(g);e.src=l(b);e.onload=function(){c("exported image size: "+[e.width,e.height]);a.width=e.width;a.height=e.height;k.drawImage(e,0,0);var b=a.toDataURL();
c(f+" length: "+b.length);d.callback?d.callback(b):c("WARNING: no callback set, so nothing happens.")};e.onerror=function(){console.log("Can't export! Maybe your browser doesn't support SVG in img element or SVG input for Canvas drawImage?\nhttp://en.wikipedia.org/wiki/SVG#Native_support")}}function p(){var a=document.createElement("canvas");a.getContext("2d");var k=h(g),e=d.keepOutsideViewport;if(e)var b=g.getBBox();canvg(a,k,{ignoreMouse:!0,ignoreAnimation:!0,offsetX:e?-b.x:void 0,offsetY:e?-b.y:
void 0,scaleWidth:e?b.width+b.x:void 0,scaleHeight:e?b.height+b.y:void 0,renderCallback:function(){c("exported image dimensions "+[a.width,a.height]);var b=a.toDataURL();c(f+" length: "+b.length);d.callback&&d.callback(b)}});return a.toDataURL()}var g=this;f||(f="image/svg+xml");d||(d={});d.keepNonSafe&&c("NOTE: keepNonSafe is NOT supported and will be ignored!");d.keepOutsideViewport&&c("NOTE: keepOutsideViewport is only supported with canvg exporter.");switch(f){case "image/svg+xml":return m();
case "image/png":d.renderer||(d.renderer=window.canvg?"canvg":"native");switch(d.renderer){case "canvg":return c("using canvg renderer for png export"),p();case "native":return c("using native renderer for png export. THIS MIGHT FAIL."),n();default:c("unknown png renderer given, doing noting ("+d.renderer+")")}break;default:c("Sorry! Exporting as '"+f+"' is not supported!")}};